# ğŸš— ìë™ì°¨ ë¶ˆëŸ‰ ë¶„ë¥˜ ë³´ì¡° ì‹œìŠ¤í…œ (VisionQC Local AI Edition)

ì´ í”„ë¡œì íŠ¸ëŠ” ìë™ì°¨ ì™¸ì¥ ì´ë¯¸ì§€ë¥¼ **ë¡œì»¬ ë¨¸ì‹ ì—ì„œ ì§ì ‘ AI ëª¨ë¸ë¡œ ë¶„ì„**í•˜ê³ , **PyQt5 ê¸°ë°˜ GUI**ë¥¼ í†µí•´ ë¶ˆëŸ‰ ì •ë³´ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒÂ·ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” **ì˜¤í”„ë¼ì¸ í’ˆì§ˆ ê´€ë¦¬ ë³´ì¡° ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤.

ê¸°ì¡´ VisionQCê°€ OpenAI Vision APIë¥¼ ì‚¬ìš©í–ˆë˜ ê²ƒê³¼ ë‹¬ë¦¬, VisionQC-Local-AIëŠ” ëª¨ë“  ë¶„ë¥˜ ì‘ì—…ì„ ìì²´ í•™ìŠµí•œ PyTorch ëª¨ë¸ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

---

## ğŸ¯ ëª©í‘œ
OpenAI Vision API ëŒ€ì‹  ResNet34 Multi-task Classification Model(.pth) ë¡œ ë¶ˆëŸ‰ ì •ë³´ë¥¼ ì¶”ë¡ í•©ë‹ˆë‹¤.

---
## ğŸ” ì»¤ìŠ¤í…€ AI ëª¨ë¸ êµ¬ì„± (ResNet34 Multi-Task Classifier)

VisionQC-Local-AIëŠ” OpenAI Vision API ëŒ€ì‹ , ì§ì ‘ í•™ìŠµí•œ ResNet34 ê¸°ë°˜ ë©€í‹°íƒœìŠ¤í¬ ë¶„ë¥˜ ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ëª¨ë¸ì€ í•œ ë²ˆì˜ ì´ë¯¸ì§€ ì…ë ¥ìœ¼ë¡œ ë‹¤ìŒ ì„¸ ê°€ì§€ ì •ë³´ë¥¼ ë™ì‹œì— ì˜ˆì¸¡í•©ë‹ˆë‹¤:

- ë¶ˆëŸ‰ ìœ í˜• (7-class)
- ì‹¬ê°ë„ (High / Medium / Low)
- ìœ„ì¹˜ (front / rear / side ë“±)

---

### ëª¨ë¸ êµ¬ì¡° ìš”ì•½
- Backbone: ResNet34 (ImageNet pretrained)
- Feature dimension: 512
- Classification heads:
  - Defect type head: 512 â†’ 6
  - Severity head: 512 â†’ 3
  - Location head: 512 â†’ 3
- Softmax ê¸°ë°˜ multi-task classification
- WeightedRandomSampler ì‚¬ìš© â†’ í•™ìŠµ ë°ì´í„° í¸ì¤‘ ë¬¸ì œ ë³´ì™„
- Stochastic Gradient Descent optimizer ì‚¬ìš© â†’ íŒŒì¸ íŠœë‹ì—ì„œ Adam ë³´ë‹¤ ì•ˆì •ì 

- Combined loss:
  total_loss = 1.0 * loss_defect + 0.7 * loss_severity + 0.7 * loss_location

---

### íŠ¹ì§•
- í•˜ë‚˜ì˜ ëª¨ë¸ë¡œ ëª¨ë“  ì •ë³´ë¥¼ ë™ì‹œì— ì˜ˆì¸¡
- ëª¨ë¸ í¬ê¸°ê°€ ì‘ì•„ CPU í™˜ê²½ì—ì„œë„ ë¹ ë¥´ê²Œ ë™ì‘
- ì™„ì „ ë¡œì»¬ ëª¨ë¸ë¡œ, ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì—†ì´ë„ ë¶„ì„ ê°€ëŠ¥

---

## âš¡ GPT Vision API ëŒ€ë¹„ ì†ë„ ìš°ìœ„

ê¸°ì¡´ VisionQC(OpenAI Vision ê¸°ë°˜)ëŠ” ì•„ë˜ì™€ ê°™ì€ í•œê³„ê°€ ìˆì—ˆìŠµë‹ˆë‹¤:

- ì´ë¯¸ì§€ base64 ì¸ì½”ë”© ë° prompt ìƒì„± í•„ìš”
- OpenAI ì„œë²„ë¡œ ìš”ì²­ ì „ì†¡ â†’ 1~2ì´ˆ ì§€ì—°
- ì¸í„°ë„· ì—°ê²° í•„ìˆ˜
- API ë¹„ìš© ë°œìƒ
- ì‘ë‹µ í˜•ì‹ì´ ìì—°ì–´ ê¸°ë°˜ì´ë¼ ë³€ë™ì„± ì¡´ì¬

VisionQC-Local-AIëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ëª¨ë‘ í•´ê²°í•©ë‹ˆë‹¤.

---

### ë¡œì»¬ AI ëª¨ë¸ì˜ ì¥ì 

- **ì••ë„ì ìœ¼ë¡œ ë¹ ë¥¸ ì†ë„**
  - GPT Vision API: 1.0 ~ 2.5ì´ˆ
  - Local AI (ResNet34): 0.03 ~ 0.12ì´ˆ (CPU ê¸°ì¤€)

- **ì™„ì „ ì˜¤í”„ë¼ì¸ ë™ì‘**
  - ì¸í„°ë„· í•„ìš” ì—†ìŒ
  - ë³´ì•ˆ ë¯¼ê° ë°ì´í„° ìœ ì¶œ ìœ„í—˜ ì—†ìŒ

- **ë¹„ìš© 0ì›**
  - API í˜¸ì¶œ ë¹„ìš© ì—†ìŒ
  - ìš”ì²­ ì œí•œ ì—†ìŒ

- **ì¼ê´€ëœ ì¶œë ¥**
  - GPTì˜ ìì—°ì–´ ê¸°ë°˜ ê²°ê³¼ ë³€ë™ì„± ì œê±°
  - í•­ìƒ ë™ì¼ êµ¬ì¡°ì˜ ê²°ê³¼(JSON-like) ì œê³µ

- **ëŒ€ëŸ‰ ì´ë¯¸ì§€ QCì— ìµœì í™”**
  - API rate limit ì—†ìŒ
  - ì‹¤ì‹œê°„ í’ˆì§ˆ ê²€ì‚¬ ìë™í™”ì— ì í•©

---

## ğŸ”§ ì»¤ìŠ¤í…€ AI ëª¨ë¸ í•™ìŠµ ë°©ì‹ â€” 2ë‹¨ê³„ íŒŒì¸íŠœë‹ ì „ëµ

ìë™ì°¨ ì™¸ì¥ ë¶ˆëŸ‰ ë°ì´í„°ëŠ” í´ë˜ìŠ¤ ê°„ ë¶ˆê· í˜•ì´ ì¡´ì¬í•˜ê³ , ì „ì²´ ë°ì´í„° ê·œëª¨ê°€ ëŒ€í˜• ë°ì´í„°ì…‹ì— ë¹„í•´ ìƒëŒ€ì ìœ¼ë¡œ ì ìŠµë‹ˆë‹¤.  
ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ VisionQC-Local-AIëŠ” **2ë‹¨ê³„ íŒŒì¸íŠœë‹(2-Phase Fine-Tuning)** ì „ëµì„ ì‚¬ìš©í•˜ì—¬ ì•ˆì •ì ì´ê³  ë†’ì€ ì„±ëŠ¥ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.

---

### **ğŸ“Œ Phase 1 â€” ìƒë‹¨ FC ë ˆì´ì–´ë§Œ í•™ìŠµ (Feature Extractor Freeze)**

- ResNet34ì˜ ëª¨ë“  convolutional layerë¥¼ **freeze**  
- ë§ˆì§€ë§‰ Fully-Connected Layer(FC Head)ë§Œ í•™ìŠµ  
- í•™ìŠµë¥ (LR)ì´ ìƒëŒ€ì ìœ¼ë¡œ ë†’ì€ ê°’ ì‚¬ìš©  
- ëª©ì :  
  - ë¹ ë¥¸ ìˆ˜ë ´  
  - ë¶„ë¥˜ headë¥¼ ë°ì´í„° ë¶„í¬ì— ë§ê²Œ ë¨¼ì € ì ì‘  
  - ê³¼ì í•© ìœ„í—˜ ê°ì†Œ  
  - ì‘ì€ ë°ì´í„°ì—ì„œë„ ì•ˆì •ì  ì´ˆê¸° ì„±ëŠ¥ í™•ë³´  

**íš¨ê³¼:**  
ë°±ë³¸ ê°€ì¤‘ì¹˜ë¥¼ ë³´ì¡´í•˜ë©´ì„œ, ì‘ì€ ë°ì´í„°ì—ì„œë„ ë¹ ë¥´ê³  ì•ˆì •ì ì¸ ì´ˆê¸° ì„±ëŠ¥ì„ ì–»ì„ ìˆ˜ ìˆìŒ.

---

### **ğŸ“Œ Phase 2 â€” ìƒìœ„ Block(layer4) + FC ë ˆì´ì–´ ë¯¸ì„¸ì¡°ì • (Fine-Tuning)**

- ResNet34 ì¤‘ **layer4 + FC headë§Œ unfreeze**  
- ë‹¤ë¥¸ ë ˆì´ì–´ëŠ” ê³„ì† freeze  
- ë” ì‘ì€ learning rate ì‚¬ìš©  
- CosineAnnealing ìŠ¤ì¼€ì¤„ ì ìš©  
- ëª©ì :  
  - ë³´ë‹¤ ì„¸ë°€í•œ feature adaptation  
  - ë¶ˆëŸ‰ íŒ¨í„´(ìŠ¤í¬ë˜ì¹˜, í¬ë™, ì°Œê·¸ëŸ¬ì§ ë“±)ì˜ ë¯¸ë¬˜í•œ ì°¨ì´ë¥¼ ë°±ë³¸ ìˆ˜ì¤€ì—ì„œ ë°˜ì˜  
  - ê³¼ì í•©ì„ í”¼í•˜ë©´ì„œ ì •ë°€ë„ í–¥ìƒ
- Early Stopping (patience = 3)ìœ¼ë¡œ ê³¼í•™ìŠµ ë°©ì§€

**íš¨ê³¼:**  
í´ë˜ìŠ¤ ê°„ ì°¨ì´ê°€ ë¯¸ë¬˜í•œ ìë™ì°¨ ì™¸ì¥ ë¶ˆëŸ‰ ì´ë¯¸ì§€ì—ì„œ  
ëª¨ë¸ì´ ì‹¤ì œ íŠ¹ì§•ì„ ë” ì˜ êµ¬ë¶„í•˜ë„ë¡ ì„±ëŠ¥ì´ í–¥ìƒë¨.

---

### **ğŸ¯ ì™œ 2ë‹¨ê³„ íŒŒì¸íŠœë‹ì¸ê°€?**

ìë™ì°¨ ì™¸ì¥ ë¶ˆëŸ‰ ë°ì´í„°ì˜ íŠ¹ì„±:

- ë°ì´í„° ì–‘ì´ ì œí•œì   
- í´ë˜ìŠ¤ ê°„ ë¶ˆê· í˜• ì¡´ì¬  
- ì´¬ì˜ ê°ë„ ë‹¤ì–‘  
- ë¼ë²¨ í’ˆì§ˆì´ ì™„ë²½í•˜ì§€ ì•ŠìŒ  
- 6-class defect + 3-class severity + 3-class location â†’ **ë©€í‹°íƒœìŠ¤í¬ êµ¬ì¡°**

ì´ëŸ° ì¡°ê±´ì—ì„œ ì „ ë ˆì´ì–´ë¥¼ í•œ ë²ˆì— í•™ìŠµí•˜ë©´:

- ê³¼ì í•© ìœ„í—˜ ì¦ê°€  
- ë¶ˆì•ˆì •í•œ gradient  
- ì´ˆê¸° í•™ìŠµ í­ì£¼ ë°œìƒ  
- ì„±ëŠ¥ í”ë“¤ë¦¼ ê°€ëŠ¥ì„± í¼

ë”°ë¼ì„œ **ë°±ë³¸ì„ ë‹¨ê³„ì ìœ¼ë¡œ í’€ì–´ì£¼ëŠ” 2ë‹¨ê³„ íŒŒì¸íŠœë‹ ë°©ì‹**ì´ ê°€ì¥ í•©ë¦¬ì ì´ë©°,  
ì‹¤ì œ í•™ìŠµì—ì„œë„ ì„±ëŠ¥Â·ì•ˆì •ì„±ì´ í¬ê²Œ í–¥ìƒë¨.

---

### **ğŸ“ˆ í•™ìŠµ ê²°ê³¼**

2ë‹¨ê³„ í•™ìŠµ ì „ëµ + Sampler ì ìš©ìœ¼ë¡œ ë‹¤ìŒ íš¨ê³¼ê°€ í™•ì¸ë¨:

- defect classification ì •í™•ë„ í–¥ìƒ  
- severity / location ë¶„ë¥˜ ì•ˆì •ì„± ì¦ê°€  
- ì¶”ë¡  ê²°ê³¼ í¸ì°¨ ê°ì†Œ  
- ë¡œì»¬ í™˜ê²½ì—ì„œë„ ë†’ì€ ì‹ ë¢°ë„ë¡œ QC ë³´ì¡° ê°€ëŠ¥

---

### âœ” ìš”ì•½

VisionQC-Local-AI ëª¨ë¸ì€ ì ì€ ë°ì´í„°ì—ì„œë„ ìµœëŒ€ ì„±ëŠ¥ì„ ëŒì–´ë‚´ê¸° ìœ„í•´  
**ResNet34 ê¸°ë°˜ ë©€í‹°íƒœìŠ¤í¬ ëª¨ë¸ + 2ë‹¨ê³„ íŒŒì¸íŠœë‹ ì „ëµ**ì„ ì ìš©í•˜ì˜€ìœ¼ë©°,

ì´ëŠ” ê¸°ì¡´ ë‹¨ì¼ ë‹¨ê³„ í•™ìŠµë³´ë‹¤  
- ë” ì•ˆì •ì ì´ë©°  
- ë” ë†’ì€ ì •í™•ë„ì™€  
- ë” ë‚®ì€ ë¶„ì‚°ì„ ê°–ëŠ” ëª¨ë¸ì„ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

---

## ğŸ“‚ ë°ì´í„°ì…‹ ì¶œì²˜

ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” **CarDD (Car Damage Dataset)** ë¥¼ í™œìš©í•˜ì—¬ local ai ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³  ì ìš©í–ˆìŠµë‹ˆë‹¤.

CarDDëŠ” ì°¨ëŸ‰ ì™¸ì¥ ì†ìƒ ì´ë¯¸ì§€ ì•½ 4,000ì¥ì„ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, ìŠ¤í¬ë˜ì¹˜, ì°Œê·¸ëŸ¬ì§, ê· ì—´, ë³€ìƒ‰, ì˜¤ì—¼ ë“± ë‹¤ì–‘í•œ ë¶ˆëŸ‰ ìœ í˜•ì„ í¬í•¨í•©ë‹ˆë‹¤.

- [CarDD ê³µì‹ í˜ì´ì§€](https://cardd-ustc.github.io/?utm_source=chatgpt.com)

---

## ğŸ” ì „ì²´ íë¦„

1. ì´ë¯¸ì§€ ì—…ë¡œë“œ
2. í”„ë¡¬í”„íŠ¸(ë¶„ë¥˜ ìš”ì²­) ì „ë‹¬
3. local ai modelì„ í†µí•œ ë¶ˆëŸ‰ ìœ í˜• ë¶„ë¥˜/ì„¤ëª…
4. ê²°ê³¼ ì¶œë ¥ ë° SQLite DB ì €ì¥
5. ê²€ìƒ‰ ê¸°ëŠ¥ìœ¼ë¡œ ë¶ˆëŸ‰ ìœ í˜•/ë‚ ì§œë³„ íƒìƒ‰
6. ë°ì´í„° ì‹œê°í™”

---

## ğŸ“¸ ì‹¤í–‰ í™”ë©´ (Execution Screenshots)

### ğŸ–¥ï¸ ë©”ì¸ í™”ë©´
ì´ë¯¸ì§€ ì—…ë¡œë“œ â†’ AI ëª¨ë¸ë¡œ ë¶„ë¥˜ â†’ DB ì €ì¥ â†’ ê²°ê³¼ í‘œì‹œ

![DB Table](./assets/db_results_table.png)
![Result](./assets/classify_result_.png)
---

### ğŸ“Š í†µê³„ ëŒ€ì‹œë³´ë“œ (Stats Dashboard)

#### 1ï¸âƒ£ Defect Distribution
ì‹¬ê°ë„(Severity)ë³„ ê²°í•¨ ë°œìƒ ë¹ˆë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ìŠ¤íƒí˜• ë°” ì°¨íŠ¸  
![Defect Distribution](./assets/Defect%20Distribution_.png)

#### 2ï¸âƒ£ Daily Trend
ì¼ìë³„ ë¶ˆëŸ‰ ë°œìƒ ì¶”ì´ë¥¼ ë³´ì—¬ì£¼ëŠ” ë¼ì¸ ì°¨íŠ¸  
![Daily Trend](./assets/Daily%20Trend.png)

#### 3ï¸âƒ£ Additional Metrics
- Defect Type Ratio (Top10)  
- Severity Ratio (A/B/C)
![Additional Metrics](./assets/Additional%20Metrics_.png)

#### 4ï¸âƒ£ Location & Action
ìœ„ì¹˜ë³„ ê²°í•¨ ë¶„í¬ ë° ì¡°ì¹˜(Action) ë¹„ìœ¨ ì‹œê°í™”  
![Location Action](./assets/Location_Action_.png)

---

### ğŸ’¾ Export ê¸°ëŠ¥
ê·¸ë˜í”„ ì €ì¥ ë° CSV ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

| ê¸°ëŠ¥ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **Save PNG** | ëŒ€ì‹œë³´ë“œ ì´ë¯¸ì§€ë¥¼ íŒŒì¼ë¡œ ì €ì¥ | ![Export Image](./assets/export_img_success.png) |
| **Export CSV** | ê·¸ë˜í”„ë³„ ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸° | ![Export CSV](./assets/export_csv_success.png) |

---

## ğŸ”§ ì‹œìŠ¤í…œ êµ¬ì„±ë„
```text
[ ì‚¬ìš©ì ]
   â†“
[ PyQt5 GUI ]
   â†“                â†˜
[ ì´ë¯¸ì§€ ì—…ë¡œë“œ + í”„ë¡¬í”„íŠ¸ ]   [ ê²€ìƒ‰ ì§ˆì˜ ]
   â†“                          â†˜
[ local ai API í˜¸ì¶œ ]      [ SQLite DB ]
   â†“                          â†—
[ ë¶ˆëŸ‰ ìœ í˜• ë¶„ë¥˜ + ì„¤ëª… ì¶œë ¥ ]
   â†“
[ ê²°ê³¼ DB ì €ì¥ ë° í™”ë©´ í‘œì‹œ ]
   â†“
[ ë°ì´í„° ì‹œê°í™” ]
```
---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```text
visionqc-local-ai/
â”œâ”€â”€ gui/
â”‚   â””â”€â”€ __init__.py
â”‚   â””â”€â”€ main_app.py
â”‚   â””â”€â”€ main_window.py
â”‚   â””â”€â”€ stats_view.py
â”œâ”€â”€ api/
â”‚   â””â”€â”€ __init__.py
â”‚   â””â”€â”€ local_ai_api.py
â”œâ”€ assets/
â”œâ”€â”€ data/                    # (Not included in the repo)
â”‚   â””â”€â”€ CarDD_COCO/
â”‚       â”œâ”€â”€ annotations/
â”‚       â”œâ”€â”€ train2017/
â”‚       â”œâ”€â”€ val2017/
â”‚       â””â”€â”€ test2017/
â”œâ”€â”€ db/
â”‚   â””â”€â”€ __init__.py
â”‚   â””â”€â”€ db.py
â”œâ”€â”€ models/
â”‚   â””â”€â”€ visionqc_multitask_resnet34_best.pth
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ 01_train_multitask_model.ipynb
â”‚   â””â”€â”€ 02_test_evaluation.ipynb
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ __init__.py
â”‚   â””â”€â”€ config.py
â”‚   â””â”€â”€ file_handler.py
â”œâ”€â”€ main.py
â”œâ”€â”€ app.db # (Not included in the repo)
â”œâ”€â”€ .env
â””â”€â”€ requirements.txt
```

---

## ğŸ“¦ requirements.txt
```text
# ----- Core (CPU PyTorch) -----
torch==2.2.2
torchvision==0.17.2
typing_extensions>=4.8.0

# ----- GUI -----
PyQt5>=5.15.10

# ----- Image / Data -----
Pillow>=10.0.1
numpy>=1.26.0,<2.0.0
pandas>=2.1.0

# ----- Utilities -----
tqdm>=4.66.0
matplotlib>=3.8.0

# ----- Config -----
python-dotenv>=1.0.0
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²• (Quickstart)

```bash
git clone https://github.com/mavro7910/visionqc-local-ai
cd visionqc-local-ai
```
```bash
# ìƒˆ ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv .venv
```
```bash
# ê°€ìƒí™˜ê²½ í™œì„±í™”
.venv\Scripts\activate
```

```bash
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -U pip setuptools wheel  # ERROR: To modify pip, please run the following command: ì—ëŸ¬ ë°œìƒ ì‹œ ì—ëŸ¬ ë‚´ìš© í•˜ë‹¨ ëª…ë ¹ì–´ë¡œ ì¬ì„¤ì¹˜
pip install -r requirements.txt
```

```bash
# ì‹¤í–‰
python main.py
```

---

## ğŸ‘¨â€ğŸ’» ê°œë°œì
**ì´ê´‘í˜¸ (Kwangho Lee)**  
ì„±ê· ê´€ëŒ€í•™êµ ê¸°ê³„ê³µí•™ë¶€  

- GitHub: [@mavro7910](https://github.com/mavro7910)  
- Email: [kwangho97@g.skku.edu]

---

## ğŸ“œ License
ì´ í”„ë¡œì íŠ¸ëŠ” [MIT License](./LICENSE)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

---